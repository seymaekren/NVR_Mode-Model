function printOptimizationFiles_IndScoringMatrix (CP, NOES, ALLDISTS, COLIN, ...
						  NTH, scoringMatrixFilename)

VERY_LARGE_NUMBER     = 1E9;
combinedScoringMatrix = zeros(size(CP));
fid                   = fopen(scoringMatrixFilename,'w');
fprintf(1, 'printing to %s\n',scoringMatrixFilename);

for rowIndex = 1:size(combinedScoringMatrix,1)
%  fprintf(fid, '%d: ', rowIndex);
  if (CP(rowIndex,rowIndex) == 0) 
    fprintf(1, 'CP matrix entry empty for peak %d\n', ...
	    rowIndex);
  end
  
  for columnIndex = 1:size(combinedScoringMatrix,2)
    
    if ((CP(rowIndex,columnIndex)   == 0))
      combinedScoringMatrix(rowIndex,columnIndex) = ...
	  VERY_LARGE_NUMBER;
      
    else
   
      combinedScoringMatrix(rowIndex,columnIndex) = - log(CP(rowIndex,columnIndex));
      
    end
    
    fprintf(fid, '%f ', combinedScoringMatrix(rowIndex, columnIndex));
    
  end
  fprintf(fid, '\n');
end

fclose(fid);
  
fid = fopen('NOE_List.txt','w');
fprintf(1, 'printing to NOE_List.txt\n');

for peak1Index = 1:size(NOES,1)
  listOfNOEs = find(NOES(peak1Index,:));
  if (~isempty(listOfNOEs))
    fprintf(fid, '%d %d ', length(listOfNOEs), peak1Index);
    for peak2Index = 1:size(NOES,2)
      %	fprintf(fid, '%d ', NOES(ROWIN(rowIndex),
      %	COLIN(columnIndex)));
      if (NOES(peak1Index,peak2Index) == 1)
	fprintf(fid, ' %d ',peak2Index);
      end
    end
    fprintf(fid, '\n');
  end
end

fclose(fid);
    
fid = fopen('BinaryDistances.txt','w');
fprintf(1, 'printing to BinaryDistances.txt\n');
for residue1Index = 1:length(COLIN)
  for residue2Index =  1:length(COLIN)
    if (ALLDISTS(COLIN(residue1Index),COLIN(residue2Index)) > NTH)
      fprintf(fid, '0 ');
    else
      fprintf(fid, '1 ');
    end
  end	
  fprintf(fid, '\n');
end
fclose(fid);
fprintf(1, 'printed all 3 files required for optimization.\n');
return

